# 画面構成一覧

**作成日**: 2025-11-20  
**バージョン**: 1.0  
**Phase**: 02

---

## 1. 画面構成概要

サポート報告書システムは以下の画面で構成されています。

### 1.1 画面一覧

| No | 画面名 | 画面ID | 種類 | 説明 | 優先度 |
|----|-------|--------|------|------|-------|
| 1 | ログイン画面 | login | 認証 | ユーザー認証 | A |
| 2 | メイン画面（一覧） | main | 一覧 | サポート報告書の一覧表示・検索 | A |
| 3 | 入力ダイアログ | input_dialog | 登録/更新 | サポート報告書の登録・編集 | A |
| 4 | 定型文選択ダイアログ | template_dialog | 選択 | 定型文の選択・挿入 | B |
| 5 | マスタ設定_商品 | master_product | マスタ | 商品マスタ管理 | B |
| 6 | マスタ設定_定型文 | master_template | マスタ | 定型文マスタ管理 | B |
| 7 | マスタ設定_対応区分 | master_category | マスタ | 対応区分マスタ管理 | C |
| 8 | マスタ設定_対応内容項目 | master_content_item | マスタ | 対応内容項目マスタ管理 | C |

---

## 2. 画面詳細仕様

### 2.1 ログイン画面

#### 2.1.1 画面概要
- **画面ID**: login
- **ファイル名**: login.php
- **用途**: システムへのログイン認証
- **アクセス**: 最初にアクセスする画面

#### 2.1.2 画面レイアウト

```
┌─────────────────────────────┐
│     LoginBox                │
├─────────────────────────────┤
│  ログインしてください...      │
├─────────────────────────────┤
│  ユーザーコード: [        ] │
│  パスワード:     [        ] │
│                             │
│  [キャンセル]  [ログイン]    │
└─────────────────────────────┘
```

#### 2.1.3 入力項目

| 項目名 | 種類 | 必須 | 説明 | 検証ルール |
|--------|------|------|------|-----------|
| ユーザーコード | テキスト | ○ | 作業担当者コード | 数値のみ |
| パスワード | パスワード | ○ | パスワード | - |

#### 2.1.4 ボタン

| ボタン名 | 処理内容 |
|---------|---------|
| キャンセル | 入力内容をクリアして終了 |
| ログイン | 認証処理を実行してメイン画面へ遷移 |

#### 2.1.5 認証処理
1. ユーザーコードとパスワードを取得
2. SQL_作業担当テーブルで認証
3. 成功時：
   - セッションに担当者情報を格納
   - メイン画面へリダイレクト
4. 失敗時：
   - エラーメッセージ表示
   - 入力欄をクリア

#### 2.1.6 WEB化時の変更点
- Accessの認証からWEB認証へ移行
- セッション管理の実装（9時間タイムアウト）
- CSRF対策の実装

---

### 2.2 メイン画面（サポート報告書一覧）

#### 2.2.1 画面概要
- **画面ID**: main
- **ファイル名**: support_main.php
- **用途**: サポート報告書の一覧表示と検索
- **アクセス**: ログイン後の初期画面

#### 2.2.2 画面レイアウト

```
┌──────────────────────────────────────────────────────────┐
│ サポート報告書 一覧 ver.11.00                              │
│ [入力] [商品] [対応区分] [対応内容] [定型文]              │
├──────────────────────────────────────────────────────────┤
│ ▼データ検索▼                                              │
├──────────────────────────────────────────────────────────┤
│  [検索条件入力エリア]                                      │
│  作業担当: [コンボボックス]  顧客名: [         ]          │
│  商品:     [コンボボックス]  対応日: [    ] ～ [    ]     │
│  対応内容: □操作説明 □データ更新 □データ調査 ...          │
│                                                          │
│  33652件                                [検索]            │
├──────────────────────────────────────────────────────────┤
│ 作業担当 | 顧客名      | 対応日時         | 対応内容 | 報告内容  │
├──────────────────────────────────────────────────────────┤
│ 新城 実咲 | 有限会社... | 2025/11/28 11:50 | 101...  | このような... [詳細/修正]│
│ 神山 祥子 | 新崎 竜子   | ...             | ...     | ...       [詳細/修正]│
│ ...                                                       │
├──────────────────────────────────────────────────────────┤
│ [終了]                    [EXCEL] [システム設定] [ログアウト]│
└──────────────────────────────────────────────────────────┘
```

#### 2.2.3 機能

##### 2.2.3.1 検索機能
データ検索エリアはアコーディオン形式で展開/収納可能

**検索条件**:

| 項目名 | 種類 | 説明 |
|--------|------|------|
| 作業担当 | コンボボックス | 担当者で絞り込み |
| 顧客名 | テキスト | 顧客名で部分一致検索 |
| 商品 | コンボボックス | 商品で絞り込み |
| 対応日 | 日付範囲 | 対応開始日時の範囲検索 |
| 対応区分 | コンボボックス | 対応区分で絞り込み |
| 対応内容 | チェックボックス | 対応内容項目で絞り込み（複数選択可） |

##### 2.2.3.2 一覧表示

**表示カラム**:

| カラム名 | データソース | 説明 |
|---------|-------------|------|
| 作業担当 | SQL_作業担当.氏名 | 担当者名 |
| 商品 | M_商品.商品名 | 商品名 |
| 対応日時 | D_作業報告.対応開始日時 | 対応開始日時 |
| 対応内容 | D_作業報告.対応内容フラグ | チェックされた項目 |
| 顧客名 | SQL_顧客.顧客名 | 顧客名 |
| 報告内容 | D_作業報告.報告内容 | 報告内容（先頭部分） |
| 操作 | - | [詳細/修正]ボタン |

**ソート機能**:
- カラムヘッダークリックでソート
- 初期表示は対応日時の降順

**ページング**:
- 1ページあたり50件表示
- ページャーで前後移動

##### 2.2.3.3 上部メニューボタン

| ボタン名 | 処理内容 |
|---------|---------|
| 入力 | 入力ダイアログを開く（新規登録） |
| 商品 | 商品マスタ設定画面を開く |
| 対応区分 | 対応区分マスタ設定画面を開く |
| 対応内容 | 対応内容項目マスタ設定画面を開く |
| 定型文 | 定型文マスタ設定画面を開く |

##### 2.2.3.4 下部ボタン

| ボタン名 | 処理内容 |
|---------|---------|
| 終了 | システムを終了（WEBでは不要） |
| EXCEL | 検索結果をExcelでダウンロード |
| システム設定 | システム設定画面を開く（将来拡張） |
| ログアウト | ログアウト処理 |

#### 2.2.4 WEB化時の変更点
- アコーディオンの実装（jQueryで展開/収納）
- Ajax検索の実装（ページリロードなし）
- レスポンシブ対応（タブレット・スマホ対応）
- 無限スクロールまたはページング実装

---

### 2.3 入力ダイアログ（サポート報告書入力）

#### 2.3.1 画面概要
- **画面ID**: input_dialog
- **ファイル名**: support_input.php
- **用途**: サポート報告書の新規登録・編集
- **アクセス**: メイン画面の[入力]ボタンまたは[詳細/修正]リンク

#### 2.3.2 画面レイアウト

```
┌──────────────────────────────────────────────────┐
│ サポート報告_入力ダイアログ               [×]     │
├──────────────────────────────────────────────────┤
│ サポート報告書                                    │
├──────────────────────────────────────────────────┤
│ [0] [        検索] ▼ [LPG支援部 ▼]               │
├──────────────────────────────────────────────────┤
│ お客様名:    [                              ]     │
│ ご担当者名:  [                              ]     │
│              対応日: [2025/11/19] [17:33] ～ [17:33]│
│ 商品名:      [▼]  [▼]                            │
│              作業担当: [根岡 大輝 ▼]              │
│ 対応内容:    □操作説明    □データ更新   □データ調査 │
│              □打合せ      □プログラム修正 □プログラム更新│
│              □プログラム確認 □運用確認   □その他    │
│              □休日対応    □プログラム納品          │
│              対応区分: [-----  ▼]                 │
├──────────────────────────────────────────────────┤
│ サポート報告:                                     │
│ [定型文]                                          │
│ ┌──────────────────────────────────────────────┐│
│ │                                              ││
│ │  （報告内容入力エリア）                        ││
│ │                                              ││
│ └──────────────────────────────────────────────┘│
│                              引継担当: [     ▼]  │
├──────────────────────────────────────────────────┤
│ [閉じる]                更新日: 2025/11/19 17:33  │
│                   [保存]  [印刷]  [削除]          │
└──────────────────────────────────────────────────┘
```

#### 2.3.3 入力項目

##### 2.3.3.1 基本情報

| 項目名 | 種類 | 必須 | 説明 | 初期値 |
|--------|------|------|------|--------|
| 顧客コード | 数値 + 検索 | ○ | 顧客コード | - |
| 部門 | コンボボックス | ○ | 対応部門 | ログインユーザーの部門 |
| お客様名 | テキスト（自動） | - | 顧客名（顧客コードから自動取得） | - |
| ご担当者名 | テキスト | | 顧客側の担当者名 | - |
| 対応日（開始） | 日時 | ○ | 対応開始日時 | 現在日時 |
| 対応日（終了） | 日時 | | 対応終了日時 | 開始日時と同じ |
| 商品名1 | コンボボックス | | 対象商品1 | - |
| 商品名2 | コンボボックス | | 対象商品2 | - |
| 作業担当 | コンボボックス | ○ | 作業担当者 | ログインユーザー |
| 対応区分 | コンボボックス | | 対応区分 | - |
| 引継担当 | コンボボックス | | 引継先の担当者 | - |

##### 2.3.3.2 対応内容チェックボックス

動的に生成（M_対応内容項目から取得）

表示例:
- □ 操作説明
- □ データ更新
- □ データ調査
- □ 打合せ
- □ プログラム修正
- □ プログラム更新
- □ プログラム確認
- □ 運用確認
- □ その他
- □ 休日対応
- □ プログラム納品

※ 最大20項目まで表示可能

##### 2.3.3.3 サポート報告

| 項目名 | 種類 | 必須 | 説明 |
|--------|------|------|------|
| サポート報告 | テキストエリア | ○ | 対応内容の詳細 |

#### 2.3.4 ボタン

| ボタン名 | 処理内容 |
|---------|---------|
| 検索 | 顧客検索ダイアログを開く |
| 定型文 | 定型文選択ダイアログを開く |
| 閉じる | ダイアログを閉じる（変更確認あり） |
| 保存 | データを保存してダイアログを閉じる |
| 印刷 | 印刷プレビュー表示 |
| 削除 | データを削除（確認メッセージあり） |

#### 2.3.5 動作仕様

##### 2.3.5.1 新規登録モード
- SEQNOは自動採番
- 作業担当はログインユーザー
- 対応日は現在日時
- その他の項目は空欄

##### 2.3.5.2 編集モード
- 既存データを読み込んで表示
- すべての項目が編集可能
- 削除ボタンが有効

##### 2.3.5.3 バリデーション
- 必須項目チェック
- 日付の妥当性チェック
- 顧客コードの存在チェック

#### 2.3.6 WEB化時の変更点
- モーダルダイアログまたは別画面での実装
- リアルタイムバリデーション
- 自動保存機能（下書き保存）
- 添付ファイル機能の追加検討

---

### 2.4 定型文選択ダイアログ

#### 2.4.1 画面概要
- **画面ID**: template_dialog
- **ファイル名**: template_select.php（Ajaxで呼び出し）
- **用途**: 定型文の選択と挿入
- **アクセス**: 入力ダイアログの[定型文]ボタン

#### 2.4.2 画面レイアウト

```
┌─────────────────────────────┐
│ 定型文選択                   │
├─────────────────────────────┤
│ 部門: [LPG支援部 ▼]          │
├─────────────────────────────┤
│ ○ お客様へのお問い合わせ...   │
│ ○ データ更新完了報告         │
│ ○ プログラム納品報告         │
│ ...                         │
├─────────────────────────────┤
│ [キャンセル]  [挿入]         │
└─────────────────────────────┘
```

#### 2.4.3 機能
- 部門でフィルタリング
- ラジオボタンで定型文を選択
- [挿入]ボタンで報告内容欄に挿入

#### 2.4.4 WEB化時の変更点
- 小さいモーダルダイアログで実装
- Ajaxで定型文リストを取得
- プレビュー表示機能

---

### 2.5 マスタ設定_商品

#### 2.5.1 画面概要
- **画面ID**: master_product
- **ファイル名**: master_product.php
- **用途**: 商品マスタの管理
- **アクセス**: メイン画面の[商品]ボタン

#### 2.5.2 画面レイアウト

```
┌──────────────────────────────────────────────────┐
│ マスタ設定 商品                                   │
├──────────────────────────────────────────────────┤
│ 部門: [  ▼]  名称: [              ] [1 ▼][使用する ▼] [保存]│
├──────────────────────────────────────────────────┤
│ 部門 | 商品コード | 商品名              | 使用区分 | 更新日    | 操作 │
├──────────────────────────────────────────────────┤
│ 20   | 1         | ちゃんぷる~EJ       | 使用する | 2022/03/16| [修正][削除]│
│ 20   | 2         | マイヘルスEJ        | 使用する | 2022/03/16| [修正][削除]│
│ 16   | 3         | SILPS             | 使用する | 2022/03/09| [修正][削除]│
│ ...                                                              │
├──────────────────────────────────────────────────┤
│ [閉じる]                                          │
└──────────────────────────────────────────────────┘
```

#### 2.5.3 機能

##### 2.5.3.1 新規登録
- 上部の入力欄に値を入力
- [保存]ボタンで登録

##### 2.5.3.2 修正
- [修正]ボタンで上部の入力欄に値をセット
- 値を変更して[保存]

##### 2.5.3.3 削除
- [削除]ボタンで削除（確認あり）
- 削除履歴に移動

#### 2.5.4 WEB化時の変更点
- インライン編集の実装
- Ajax保存
- ドラッグ&ドロップでの並び替え機能

---

### 2.6 マスタ設定_定型文

#### 2.6.1 画面概要
- **画面ID**: master_template
- **ファイル名**: master_template.php
- **用途**: 定型文マスタの管理

#### 2.6.2 画面レイアウト

```
┌──────────────────────────────────────────────────┐
│ マスタ設定 定型文                                 │
├──────────────────────────────────────────────────┤
│ 部門: [LPG支援部 ▼]  定型文コード: [  ]          │
│ ┌────────────────────────────────────────────┐   │
│ │                                            │   │
│ │  （定型文内容入力エリア）                    │   │
│ │                                            │   │
│ └────────────────────────────────────────────┘   │
│                                    [保存]         │
├──────────────────────────────────────────────────┤
│ コード | 定型文（先頭80文字）         | 更新日    | 操作 │
├──────────────────────────────────────────────────┤
│ 1      | お客様へお問い合わせ...      | 2024/01/15| [修正][削除]│
│ 2      | データ更新完了しました...    | 2024/02/20| [修正][削除]│
│ ...                                                │
├──────────────────────────────────────────────────┤
│ [閉じる]                                          │
└──────────────────────────────────────────────────┘
```

#### 2.6.3 WEB化時の変更点
- リッチテキストエディタの導入検討
- カテゴリ分類機能の追加
- テンプレート変数機能（顧客名など自動置換）

---

### 2.7 マスタ設定_対応区分

#### 2.7.1 画面概要
- **画面ID**: master_category
- **ファイル名**: master_category.php
- **用途**: 対応区分マスタの管理

#### 2.7.2 画面レイアウト

マスタ設定_商品と同様の構成
- 対応区分コード
- 対応区分名

---

### 2.8 マスタ設定_対応内容項目

#### 2.8.1 画面概要
- **画面ID**: master_content_item
- **ファイル名**: master_content_item.php
- **用途**: 対応内容項目マスタの管理

#### 2.8.2 画面レイアウト

マスタ設定_商品と同様の構成
- 項目コード（1〜20）
- 項目名

#### 2.8.3 特記事項
- 項目コードは1〜20に限定
- 並び順はコード順で表示

---

## 3. 画面遷移

```
[ログイン画面]
     ↓ ログイン成功
[メイン画面]
     ├→ [入力] → [入力ダイアログ] → [定型文選択]
     ├→ [詳細/修正] → [入力ダイアログ]
     ├→ [商品] → [マスタ設定_商品]
     ├→ [対応区分] → [マスタ設定_対応区分]
     ├→ [対応内容] → [マスタ設定_対応内容項目]
     ├→ [定型文] → [マスタ設定_定型文]
     └→ [ログアウト] → [ログイン画面]
```

---

## 4. 共通UI要素

### 4.1 ヘッダー
すべての画面に共通のヘッダーを表示
- システム名
- バージョン番号
- ログインユーザー名
- ログアウトボタン

### 4.2 メニュー
メイン画面のボタンと同じメニューをヘッダーに配置

### 4.3 フッター
- コピーライト
- バージョン情報

### 4.4 カラーテーマ
- メインカラー: オレンジ（#FFA500系）
- サブカラー: ライトグレー
- アクセントカラー: ライトイエロー（ハイライト）

---

## 5. レスポンシブ対応

### 5.1 PC（1024px以上）
- フル機能表示
- マルチカラムレイアウト

### 5.2 タブレット（768px〜1023px）
- 2カラムレイアウト
- 一部機能を折りたたみ

### 5.3 スマートフォン（767px以下）
- 1カラムレイアウト
- ハンバーガーメニュー
- 必要最小限の機能のみ表示

---

## 6. Phase別実装優先度

### Phase 09-10（DB接続まで）
- ログイン画面（簡易版）
- メイン画面（一覧のみ、検索なし）

### Phase 11（メイン画面簡易版）
- メイン画面（検索機能追加）
- 入力ダイアログ（基本機能）

### Phase 12以降（将来拡張）
- 定型文選択
- マスタ設定画面
- 印刷機能
- Excel出力
- 高度な検索機能

---

**完了日**: 2025-11-20  
**レビュー**: Phase 02完了時に最終確認
