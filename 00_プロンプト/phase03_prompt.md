# サポート報告書WEBシステム開発プロジェクト - Phase 03 開始プロンプト

## Phase 02 完了状況

### ✅ Phase 02で作成した成果物

#### 02_分析/ディレクトリ
1. ✅ テーブル定義書.md - SQL Serverの全テーブル構造を整理
2. ✅ ストアドプロシージャ一覧.md - 全SPの役割と仕様を記録
3. ✅ VBA処理分析結果.md - VBAロジックのPHP化方針を明確化
4. ✅ クエリ定義一覧.md - 全クエリの整理と実装方針
5. ✅ 画面構成一覧.md - 各画面の項目・機能を詳細に整理
6. ✅ 画面遷移図.md - 画面間の遷移フローを図解
7. ✅ 機能要件定義書.md - システムが実現すべき機能を定義
8. ✅ データ移行方針.md - 既存データの移行方法を策定
9. ✅ 参考システム分析結果.md - ois-webシステムの分析
10. ✅ 非機能要件定義書.md - 性能・保守性・セキュリティ等の要件を定義

#### 01_規約/ディレクトリ
1. ✅ 開発規約書.md（v1.1） - Phase 02の分析結果を反映した改訂版
2. ✅ 画面設計基本方針.md - 画面設計の統一方針を策定

### 📊 Phase 02の分析結果サマリー

#### データベース
- **テーブル数**: 14テーブル（マスタ5、データ9）
- **ストアドプロシージャ**: 41個（SELECT 15、INSERT 10、UPDATE 10、DELETE 6）
- **主要テーブル**: D_サポート報告書、M_担当者、M_商品、M_定型文、M_対応区分、M_対応内容項目

#### 画面構成
- **ログイン画面**: 担当者コード・パスワードで認証
- **メイン画面**: 一覧表示、検索機能、新規登録・編集・削除
- **入力ダイアログ（モーダル）**: サポート報告書の登録・更新
- **マスタ保守画面**: 商品、定型文、対応区分、対応内容項目の管理

#### 重要な機能
- **商品選択**: 最大3件まで選択可能
- **定型文選択**: モーダルダイアログで選択し、対応内容に挿入
- **対応内容チェックボックス**: 20項目からチェック（ビットマスク保存）
- **検索機能**: アコーディオン形式、複数条件での絞り込み
- **ページング**: 50件/ページ、OFFSET-FETCH使用

#### 技術的ポイント
- **VBA処理のPHP化**: 日付処理、文字列処理、データ操作をPHPで再現
- **Ajax通信**: 商品検索、定型文取得等
- **レスポンシブ対応**: PC/Tablet/SP用のCSS分離

---

## Phase 03の実施内容

### 目標
システムの基本設計を完成させ、Phase 04（詳細設計）、Phase 05（製造）への準備を整える。

### 実施タスク

#### 1. 画面設計書の作成（03_設計/画面設計書/）

以下の画面について、詳細な設計書を作成する：

##### 1.1 ログイン画面設計書（login.md）
- 画面レイアウト（PC/Tablet/SP）
- 入力項目（担当者コード、パスワード）
- バリデーション（必須チェック、認証処理）
- 画面遷移（成功時→メイン画面、失敗時→エラー表示）
- セッション管理方針

##### 1.2 メイン画面設計書（main.md）
- 画面レイアウト（ヘッダー、検索エリア、一覧エリア、ボタンエリア）
- ヘッダー部（システム名、ユーザー名、ログアウトボタン）
- 検索エリア（アコーディオン形式、検索条件項目）
- 一覧表示エリア（テーブル形式、表示項目、ソート機能、ページング）
- 操作ボタン（新規登録、編集、削除）
- Ajax通信仕様

##### 1.3 入力ダイアログ設計書（input_dialog.md）
- モーダルダイアログのレイアウト
- 入力項目の詳細（受付日、担当者、顧客名、商品選択、対応区分、対応内容項目、対応内容、備考）
- 商品選択ダイアログ（最大3件）
- 定型文選択ダイアログ
- 対応内容チェックボックス（20項目）
- バリデーション（クライアント・サーバー）
- データ保存処理（INSERT/UPDATE）

##### 1.4 マスタ保守画面設計書（master.md）
- 商品マスタ保守
- 定型文マスタ保守
- 対応区分マスタ保守
- 対応内容項目マスタ保守
- 各マスタ共通の機能（一覧表示、新規登録、編集、削除、検索）

#### 2. 機能設計書の作成（03_設計/機能設計書/）

##### 2.1 ログイン・認証機能設計書（auth.md）
- ログイン処理の詳細フロー
- セッション管理の仕様
- タイムアウト処理
- ログアウト処理
- 認証チェック方法

##### 2.2 検索機能設計書（search.md）
- 検索条件の詳細
- SQL生成ロジック
- 検索結果の表示方法
- ページング処理
- ソート処理

##### 2.3 登録・更新機能設計書（crud.md）
- 新規登録処理フロー
- 更新処理フロー
- 削除処理フロー
- バリデーション処理
- トランザクション管理
- エラーハンドリング

##### 2.4 商品選択機能設計書（product_select.md）
- 商品検索処理
- 商品選択処理（最大3件）
- Ajax通信仕様
- 選択結果の反映方法

##### 2.5 定型文選択機能設計書（template_select.md）
- 定型文一覧取得
- 定型文選択処理
- Ajax通信仕様
- 対応内容への挿入ロジック

##### 2.6 マスタ保守機能設計書（master_maintenance.md）
- マスタ一覧表示
- マスタ新規登録
- マスタ更新
- マスタ削除
- 共通処理の設計

#### 3. データフロー図の作成（03_設計/）

##### 3.1 データフロー図（data_flow.md）
- システム全体のデータフロー
- 各処理でのデータの流れ
- データの入出力
- 外部システムとの連携（なし）

#### 4. API設計書の作成（03_設計/）

##### 4.1 内部API設計書（api_spec.md）
- Ajax処理のAPI仕様
  - 商品検索API
  - 定型文取得API
  - データ取得API（一覧、詳細）
  - データ保存API（登録、更新、削除）
- リクエスト・レスポンスの形式
- エラーレスポンスの定義

#### 5. システム全体設計書の作成（03_設計/）

##### 5.1 システム全体設計書（system_overview.md）
- システムアーキテクチャ
- 各層の役割（プレゼンテーション層、ビジネスロジック層、データアクセス層）
- ファイル構成
- 共通処理の設計
- エラーハンドリング方針
- ログ出力方針

---

## Phase 03で作成する成果物一覧

### 03_設計/画面設計書/
1. login.md - ログイン画面設計書
2. main.md - メイン画面設計書
3. input_dialog.md - 入力ダイアログ設計書
4. master.md - マスタ保守画面設計書

### 03_設計/機能設計書/
1. auth.md - ログイン・認証機能設計書
2. search.md - 検索機能設計書
3. crud.md - 登録・更新機能設計書
4. product_select.md - 商品選択機能設計書
5. template_select.md - 定型文選択機能設計書
6. master_maintenance.md - マスタ保守機能設計書

### 03_設計/
1. system_overview.md - システム全体設計書
2. data_flow.md - データフロー図
3. api_spec.md - 内部API設計書

### 00_プロンプト/
1. phase04_prompt.md - Phase 04開始用プロンプト

---

## 設計時の注意事項

### 参照すべきドキュメント

#### Phase 01の規約（必須参照）
- `01_規約/開発規約書.md（v1.1）` - 開発の基本ルール
- `01_規約/コーディング規約書.md` - コーディングルール
- `01_規約/ディレクトリ構造設計書.md` - ファイル配置ルール
- `01_規約/画面設計基本方針.md` - 画面設計の統一方針

#### Phase 02の分析結果（必須参照）
- `02_分析/テーブル定義書.md` - DB構造
- `02_分析/ストアドプロシージャ一覧.md` - SP仕様
- `02_分析/VBA処理分析結果.md` - VBAのPHP化方針
- `02_分析/画面構成一覧.md` - 各画面の詳細
- `02_分析/画面遷移図.md` - 画面の流れ
- `02_分析/機能要件定義書.md` - 実現すべき機能
- `02_分析/非機能要件定義書.md` - 性能・保守性等の要件

### 設計の基本方針

1. **既存システムとの連続性**
   - Accessシステムからの移行をスムーズに
   - 既存の操作感を踏襲

2. **使いやすさ最優先**
   - ユーザーが直感的に操作できる設計
   - エラーメッセージは具体的で分かりやすく

3. **レスポンシブ対応**
   - PC/Tablet/SPで最適な表示
   - デバイスごとに操作性を最適化

4. **保守性の確保**
   - モジュール化された設計
   - 共通処理の関数化
   - 将来的な拡張を考慮

5. **性能の確保**
   - レスポンスタイム目標を達成
   - ページング、Ajax通信の活用

### 設計書の記載内容

各設計書には以下を必ず記載する：

1. **概要**: 画面/機能の目的と役割
2. **レイアウト**: PC/Tablet/SP別のレイアウト（図解含む）
3. **項目定義**: 各入力項目の詳細（型、桁数、必須/任意、デフォルト値等）
4. **処理フロー**: 処理の流れをフローチャートまたはテキストで記載
5. **バリデーション**: 入力チェックの詳細
6. **データベース連携**: 使用するテーブル・SP
7. **Ajax通信**: 非同期通信の仕様
8. **エラーハンドリング**: エラー時の動作
9. **画面遷移**: 遷移先と遷移条件
10. **備考**: その他の注意事項

---

## 作業ディレクトリ

```
D:\#M\PG_DATA\OIS社内システム\PG_DATA\サポート報告書WEB\
```

## 成果物の出力先

### 画面設計書
```
D:\#M\PG_DATA\OIS社内システム\PG_DATA\サポート報告書WEB\03_設計\画面設計書\
```

### 機能設計書
```
D:\#M\PG_DATA\OIS社内システム\PG_DATA\サポート報告書WEB\03_設計\機能設計書\
```

### その他設計書
```
D:\#M\PG_DATA\OIS社内システム\PG_DATA\サポート報告書WEB\03_設計\
```

### Phase 04プロンプト
```
D:\#M\PG_DATA\OIS社内システム\PG_DATA\サポート報告書WEB\00_プロンプト\
```

---

## 実施手順

### ステップ1: ディレクトリ作成
以下のディレクトリを作成：
- `03_設計/画面設計書/`
- `03_設計/機能設計書/`

### ステップ2: 画面設計書の作成
1. login.md（ログイン画面）
2. main.md（メイン画面）
3. input_dialog.md（入力ダイアログ）
4. master.md（マスタ保守画面）

### ステップ3: 機能設計書の作成
1. auth.md（ログイン・認証機能）
2. search.md（検索機能）
3. crud.md（登録・更新機能）
4. product_select.md（商品選択機能）
5. template_select.md（定型文選択機能）
6. master_maintenance.md（マスタ保守機能）

### ステップ4: その他設計書の作成
1. system_overview.md（システム全体設計書）
2. data_flow.md（データフロー図）
3. api_spec.md（内部API設計書）

### ステップ5: Phase 04用プロンプトの作成
- phase04_prompt.md

---

## 重要な制約事項

### プロジェクト実行制約
1. **AI主導開発**: Claude AIが全工程を実施
2. **フェーズ管理**: フェーズごとに新規チャット
3. **プロンプト継承**: チャットを跨いでもプロジェクトの規約や工程を把握できるようにする
4. **日本語命名**: チャットのタイトルは日本語で命名

### 技術制約
1. **既存資産の活用**: SQL Serverデータベースとストアドプロシージャをそのまま継承
2. **標準技術の採用**: PHP + HTML + CSS + jQueryによる標準的なWEBアプリケーション構成
3. **参考システムの活用**: 既存のois-webシステムの構造・関数を参考にする
4. **社内ネットワーク限定**: セキュリティは社内ネットワーク前提で最小限

---

## Phase 03の成功基準

### 完了条件
以下の全ての成果物が作成され、Phase 04（詳細設計）に進める状態になっていること：

1. ✅ 画面設計書4本（login, main, input_dialog, master）
2. ✅ 機能設計書6本（auth, search, crud, product_select, template_select, master_maintenance）
3. ✅ システム全体設計書（system_overview）
4. ✅ データフロー図（data_flow）
5. ✅ 内部API設計書（api_spec）
6. ✅ Phase 04用プロンプト（phase04_prompt）

### 品質基準
- 全ての設計書が画面設計基本方針に準拠している
- 設計書間で矛盾がない
- Phase 02の分析結果が適切に反映されている
- Phase 04（詳細設計）に必要な情報が全て含まれている

---

## 開始指示

上記の内容を踏まえて、Phase 03（基本設計）を開始してください。

**実施順序**:
1. ディレクトリ作成
2. 画面設計書の作成（login → main → input_dialog → master）
3. 機能設計書の作成（auth → search → crud → product_select → template_select → master_maintenance）
4. その他設計書の作成（system_overview → data_flow → api_spec）
5. Phase 04用プロンプトの作成

**重要事項**:
- 全ての成果物は作業ディレクトリ配下の適切な場所に出力してください
- Phase 02の分析結果を必ず参照してください
- 画面設計基本方針に従って設計してください
- 設計書は詳細かつ具体的に記載してください
- Phase 04で製造を開始できるレベルの設計を目指してください

---

**Phase 03 開始**: このプロンプトを新しいチャットで実行してください。  
**チャットタイトル（日本語）**: 「サポート報告書WEB化 Phase03 基本設計」

---

**Phase 02での作業内容サマリー**:
- 分析資料10本を作成（テーブル定義、SP一覧、VBA分析、クエリ定義、画面構成、画面遷移、機能要件、データ移行、参考システム、非機能要件）
- 規約2本を改訂・作成（開発規約書v1.1、画面設計基本方針）
- Phase 03用プロンプトを作成

**Phase 03での目標**:
- 画面設計書、機能設計書、システム設計書を作成
- Phase 04（詳細設計）への準備を完了させる
- 製造を開始できるレベルの設計を完成させる
