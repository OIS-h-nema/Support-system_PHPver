# Phase 09 検証・調整 開始プロンプト

**作成日**: 2025-11-25  
**前Phase**: Phase 08（製造 - マスタ設定・Excel出力）  
**次Phase**: Phase 10（検証環境デプロイ）

---

## プロジェクト概要

### 達成目標
現在Accessで動いてるシステムのWEB版をリリースする

### システム概要
自社の社員向けに、日々の顧客からの問い合わせや、それに対する対応を入力し、記録・分析を行うもの

### 技術スタック
- **DB**: SQL Server 2022（継続）
- **DB接続**: PDO（PHP）
- **データ操作**: ストアドプロシージャ（継続）/（一部PHP）
- **フロント**: PHP 7.4+ / HTML5 / CSS3 / jQuery 1.11.3

---

## 作業ディレクトリ

- **作業ディレクトリ**: `D:\#M\PG_DATA\OIS社内システム\PG_DATA\サポート報告書WEB\`
- **検証ディレクトリ**: `\\LPG-NEMA\C\inetpub\wwwroot\support-system\`
- **本番ディレクトリ**: `\\DEV-SE\C\inetpub\wwwroot\support-system\`

---

## Phase 08 完了成果物

### Excel出力機能
1. `export_excel.php` - CSV形式でExcel出力
   - 検索条件反映
   - Shift-JIS文字コード対応（Excel互換）
   - 全項目出力

### マスタ設定画面
2. `master_shohin.php` - 商品マスタ設定画面
3. `master_kubun.php` - 対応区分マスタ設定画面
4. `master_content.php` - 対応内容項目マスタ設定画面
5. `master_teikei.php` - 定型文マスタ設定画面
6. `master_ajax.php` - マスタ設定用Ajax処理
   - 一覧取得（action=list）
   - 単一取得（action=get）
   - 保存（action=save）
   - 削除（action=delete）
7. `js/master.js` - マスタ設定用JavaScript
8. `css/master.css` - マスタ設定用CSS

### メイン画面修正
9. `support_main.php` - ナビゲーションとExcel出力機能追加

---

## Phase 09 作業内容

### 目的
全機能の動作確認を行い、バグ修正・調整を実施する。

### 作業項目

#### 1. 動作確認項目

##### ログイン機能
- [ ] 正常ログイン（正しいID/パスワード）
- [ ] 認証エラー（間違ったID/パスワード）
- [ ] 空入力バリデーション
- [ ] セッションタイムアウト確認
- [ ] ログアウト機能

##### メイン画面（検索・一覧）
- [ ] 初期表示（一覧読み込み）
- [ ] 検索条件入力・検索実行
- [ ] 検索結果表示
- [ ] ページネーション（最初/前/次/最後）
- [ ] 表示件数切り替え
- [ ] ソート機能（カラムクリック）
- [ ] 検索条件クリア
- [ ] 検索アコーディオン開閉
- [ ] 権限制御（管理者メニュー表示/非表示）

##### 入力ダイアログ
- [ ] 新規登録ダイアログ表示
- [ ] 編集ダイアログ表示（データ読み込み）
- [ ] 顧客コード入力・検索
- [ ] 顧客検索ダイアログ
- [ ] 対応日時入力
- [ ] 商品選択（複数）
- [ ] 対応区分選択
- [ ] 対応内容チェックボックス
- [ ] 報告内容入力
- [ ] 定型文選択ダイアログ
- [ ] 定型文反映
- [ ] 引継担当選択
- [ ] バリデーションエラー表示
- [ ] 保存処理（新規・更新）
- [ ] 削除処理（管理者のみ）
- [ ] ダイアログ閉じる

##### マスタ設定画面（管理者のみ）
- [ ] 商品マスタ一覧表示
- [ ] 商品マスタ新規登録
- [ ] 商品マスタ編集
- [ ] 商品マスタ削除
- [ ] 対応区分マスタ一覧表示
- [ ] 対応区分マスタ新規登録
- [ ] 対応区分マスタ編集
- [ ] 対応区分マスタ削除
- [ ] 対応内容項目マスタ一覧表示
- [ ] 対応内容項目マスタ新規登録
- [ ] 対応内容項目マスタ編集
- [ ] 対応内容項目マスタ削除
- [ ] 定型文マスタ一覧表示
- [ ] 定型文マスタ新規登録
- [ ] 定型文マスタ編集
- [ ] 定型文マスタ削除
- [ ] 部門フィルタ機能
- [ ] 使用区分フィルタ機能

##### Excel出力
- [ ] 検索結果のExcel出力
- [ ] 検索条件反映確認
- [ ] 文字化け確認
- [ ] 日付フォーマット確認
- [ ] 全項目出力確認

##### レスポンシブ対応
- [ ] PC表示
- [ ] タブレット表示
- [ ] スマートフォン表示

#### 2. バグ修正・調整

発見された問題点を修正し、動作を調整する。

#### 3. コード品質確認

- [ ] PHPエラー・警告の確認
- [ ] JavaScriptエラーの確認
- [ ] SQLインジェクション対策確認
- [ ] XSS対策確認
- [ ] 権限制御確認

### 格納先
- バグ修正は `04_製造/` の各ファイル
- テスト結果は `05_検証/` に記録

---

## 必須参照ドキュメント

### 製造成果物
1. `04_製造/login.php`
2. `04_製造/logout.php`
3. `04_製造/support_main.php`
4. `04_製造/support_ajax01.php`
5. `04_製造/support_ajax02.php`
6. `04_製造/support_dialog.php`
7. `04_製造/export_excel.php`
8. `04_製造/master_shohin.php`
9. `04_製造/master_kubun.php`
10. `04_製造/master_content.php`
11. `04_製造/master_teikei.php`
12. `04_製造/master_ajax.php`
13. `04_製造/includes/` - 全ファイル
14. `04_製造/js/` - 全ファイル
15. `04_製造/css/` - 全ファイル

### 設計書
1. `03_設計/画面設計書/` - 全ファイル
2. `03_設計/機能設計書/` - 全ファイル
3. `03_設計/api_spec.md`

---

## 作業進行の制約

1. **大容量ファイルの分割処理**
   - ファイル読み込みは必要に応じて分割
   - ファイル書き込みも大きい場合は分割

2. **成果物出力**
   - 作業ディレクトリのみにファイル出力
   - チャットでは出力結果の報告のみ

3. **トークン節約**
   - 長尺タスクは分割処理
   - 不要な出力を控える

4. **チャット容量管理**
   - 容量オーバーになる前に次チャット立ち上げを促す
   - プロンプトファイルを生成して継続性を確保

---

## 作業開始指示

1. 上記の製造成果物を確認
2. 動作確認項目に沿ってテスト実施
3. 発見された問題点をリストアップ
4. バグ修正・調整を実施
5. 修正後の再テスト
6. テスト結果を整理
7. Phase 10用プロンプトを生成

---

## テスト実施方法

### 検証環境への仮デプロイ（オプション）

検証環境にファイルをコピーして実機テストを行う場合：

1. 04_製造/ 配下のファイルを検証ディレクトリにコピー
2. config.phpのDB接続設定を確認
3. ブラウザからアクセスしてテスト

### ローカル確認

コードレビューベースでの確認も有効：

1. PHPファイルの構文確認
2. JavaScriptの動作確認
3. CSSの表示確認
4. SQLクエリの確認

---

## 品質チェックリスト

Phase 09完了時に以下を確認：

### 機能面
- [ ] 全機能が設計通りに動作するか
- [ ] エラーハンドリングが適切か
- [ ] バリデーションが機能するか

### セキュリティ面
- [ ] 認証・認可が正しく動作するか
- [ ] SQLインジェクション対策済みか
- [ ] XSS対策済みか

### 品質面
- [ ] PHPエラー・警告がないか
- [ ] JavaScriptエラーがないか
- [ ] レスポンシブ表示が正常か

### ドキュメント
- [ ] テスト結果が記録されているか
- [ ] 修正履歴が記録されているか

---

## 既知の確認事項

### データベース接続
- サーバー: dev-se02\SQL22
- データベース: SUPPORTDB
- 認証: sa / OIS8973113fmv

### テスト用アカウント
- SQL_作業担当テーブルに登録されている担当者コードとパスワードを使用

---

**作成者**: Claude AI  
**Phase 08完了日**: 2025-11-25
