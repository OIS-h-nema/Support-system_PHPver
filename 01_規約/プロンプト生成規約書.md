# サポート報告書WEBシステム プロンプト生成規約書

**作成日**: 2025-11-25  
**バージョン**: 1.0  
**Phase**: 01

---

## 1. 概要

### 1.1 目的
本規約書は、フェーズ間でのチャット移行時に生成するプロンプトの標準形式を定め、プロジェクト情報の確実な継承と作業の継続性を保証するものです。

### 1.2 適用範囲
- 全フェーズ間のチャット移行時
- チャットのトークン容量が70%を超えた時
- プロジェクト方針の大幅変更時

### 1.3 プロンプトの役割
1. **情報継承**: プロジェクト全体像と進捗状況の伝達
2. **作業指示**: 次フェーズの具体的タスクの明示
3. **規約伝達**: 開発規約・制約事項の徹底
4. **継続性確保**: チャット間のシームレスな作業継続

---

## 2. プロンプトの基本方針

### 2.1 生成原則
1. **必須性**: 各フェーズ終了時に必ず生成する
2. **完全性**: プロジェクト再開に必要な情報を全て含む
3. **明確性**: 次の作業内容が即座に理解できる
4. **簡潔性**: トークン節約を意識し、要点を絞る

### 2.2 ファイル管理
- **格納場所**: `00_プロンプト/`
- **命名規則**: `Phase[現在番号]_to_Phase[次番号].md`
  - 例: `Phase01_to_Phase02.md`, `Phase05_to_Phase06.md`
- **文字コード**: UTF-8（BOMなし）
- **改行コード**: LF

### 2.3 サイズ管理
- **推奨サイズ**: 8,000～10,000トークン
- **最大サイズ**: 15,000トークン
- **超過時の対応**: 
  - 要点のみに絞り込む
  - 詳細は別ファイル参照に切り替え
  - 規約の全文記載を要約に変更

---

## 3. プロンプトの標準構造

### 3.1 必須セクション
以下のセクションは全てのプロンプトに必須です：

1. **プロジェクト概要** - 達成目標、システム概要、仕様
2. **環境情報** - ディレクトリパス、参照システム
3. **プロジェクトの制約事項** - AI主導開発、トークン節約等
4. **前フェーズまでの進捗** - 完了フェーズ、成果物、引き継ぎ事項
5. **当フェーズの作業内容** - タスク、成果物、参照ドキュメント
6. **規約・制約の要点** - 開発規約、コーディング規約の要点
7. **作業開始時の確認事項** - 初期確認、初期タスク、注意事項
8. **次フェーズへの準備** - 完了確認、プロンプト生成タイミング
9. **特別指示事項** - AI動作への指示、エラー対応、報告形式
10. **チェックリスト** - 生成時、開始時、終了時のチェック項目

### 3.2 テンプレート構造
```markdown
# サポート報告書WEBシステム Phase [番号] 開始プロンプト

**作成日**: YYYY-MM-DD  
**対象Phase**: Phase [番号]  
**前Phase**: Phase [番号]  
**作成者**: Claude AI

---

## 1. プロジェクト概要
[達成目標、システム概要、旧/新システム仕様]

## 2. 環境情報
[作業/検証/本番ディレクトリ、参照システム]

## 3. プロジェクトの制約事項
[AI主導開発、フェーズ管理、トークン節約、ファイル出力]

## 4. 前フェーズまでの進捗
[完了フェーズ、主要成果物、引き継ぎ事項]

## 5. 当フェーズ（Phase [番号]）の作業内容
[フェーズ概要、実施タスク、成果物と格納場所、参照ドキュメント]

## 6. 規約・制約の要点
[開発規約、コーディング規約、ディレクトリ構造の要点]

## 7. 作業開始時の確認事項
[初期確認、初期タスク、作業中の注意事項]

## 8. 次フェーズへの準備
[完了確認項目、次プロンプト生成タイミング、含めるべき情報]

## 9. 特別指示事項
[AI動作への指示、エラー対応手順、報告形式]

## 10. チェックリスト
[生成時、開始時、終了時のチェック項目]

## 11. バージョン管理
[プロンプトの改訂、修正履歴の記載]

## 12. 参考情報
[プロジェクト関連ドキュメント、参照システム、データベース]

## 13. 補足事項
[トークン節約、よくある問題と解決策]
```

---

## 4. 各セクションの記載ガイドライン

### 4.1 プロジェクト概要
**目的**: プロジェクトの全体像を把握

**記載内容**:
- 達成目標（簡潔に）
- システム概要（2-3文）
- 旧システム仕様（箇条書き）
- 新システム仕様（箇条書き）

**記載例**:
```markdown
### 1.1 達成目標
現在MS Accessで稼働しているサポート報告書管理システムをWEB化し、社内ネットワーク上で利用可能にする。

### 1.2 システム概要
自社の社員向けに、日々の顧客からの問い合わせや、それに対する対応を入力し、記録・分析を行うシステム。

### 1.3 旧システム仕様
- DB: SQL Server
- DB接続: PDO
- データ操作: ストアドプロシージャ（一部VBA）
- フロント: MS Access

### 1.4 新システム仕様
- DB: SQL Server（継続）
- DB接続: PDO（PHP）
- データ操作: ストアドプロシージャ（継続）/（一部PHP）
- フロント: PHP/HTML/CSS/jQuery
```

### 4.2 環境情報
**目的**: 作業環境のパスを明確化

**記載内容**:
- 作業ディレクトリの絶対パス
- 検証ディレクトリの絶対パス
- 本番ディレクトリの絶対パス
- 参照システムのパス

**注意事項**:
- パスは必ず正確に記載
- Windowsパス（\記号）を使用
- 存在しないパスは記載しない

### 4.3 プロジェクトの制約事項
**目的**: プロジェクト全体の制約を徹底

**記載内容**:
- AI主導開発の方針
- フェーズ管理の方法
- トークン節約の具体策
- ファイル出力のルール

**重要度**: 最重要（必ず遵守）

### 4.4 前フェーズまでの進捗
**目的**: これまでの成果を把握

**記載内容**:
- 完了フェーズの一覧表
- 各フェーズの主要成果物リスト
- 次フェーズへの引き継ぎ事項

**更新頻度**: フェーズごとに必ず更新

### 4.5 当フェーズの作業内容
**目的**: 今回の作業を明確化

**記載内容**:
- フェーズ概要（名称、目的）
- 実施タスクのチェックリスト
- 成果物リストと格納場所の表
- 参照すべきドキュメントのリスト

**重要度**: 最重要（作業の基準）

**記載例**:
```markdown
### 5.2 実施タスク
- [ ] 現行Accessシステムの詳細分析
  - [ ] テーブル構造の抽出
  - [ ] ストアドプロシージャ一覧の作成
  - [ ] VBA処理の分析
- [ ] 機能要件の洗い出し
- [ ] 要件定義書の作成
- [ ] Phase 03用プロンプトの生成

### 5.3 成果物と格納場所
| No | 成果物名 | 格納場所 | 形式 |
|----|---------|---------|------|
| 1 | テーブル定義書.md | 02_分析/ | .md |
| 2 | 機能要件定義書.md | 02_分析/ | .md |
| 3 | phase03_prompt.md | 00_プロンプト/ | .md |
```

### 4.6 規約・制約の要点
**目的**: 規約を簡潔に伝達

**記載内容**:
- 開発規約の要点（技術スタック、命名規則、セキュリティ）
- コーディング規約の要点（言語別の規約）
- ディレクトリ構造の概要

**注意事項**:
- 全文は記載しない（要点のみ）
- 詳細は規約書を参照するよう指示
- フェーズ固有の規約があれば追記

### 4.7 作業開始時の確認事項
**目的**: スムーズな作業開始を支援

**記載内容**:
- 初期確認（ディレクトリ、ドキュメント、前成果物）
- 初期タスク（環境確認、規約確認、タスク開始）
- 作業中の注意事項（ファイル出力、トークン管理、エラー対応）

**重要度**: 高（作業開始の手順）

### 4.8 次フェーズへの準備
**目的**: フェーズ完了条件を明確化

**記載内容**:
- 完了確認項目のチェックリスト
- 次プロンプト生成のタイミング
- 次プロンプトに含めるべき情報

**注意事項**:
- 完了条件は具体的に
- 生成タイミングは明確に

### 4.9 特別指示事項
**目的**: AI動作の制御

**記載内容**:
- 必須動作/禁止動作/推奨動作
- エラー時の対応手順（パスエラー、ファイルエラー、DBエラー）
- 報告形式のテンプレート

**重要度**: 最重要（AI動作の基準）

### 4.10 チェックリスト
**目的**: 品質保証

**記載内容**:
- プロンプト生成時のチェック項目
- フェーズ開始時のチェック項目
- フェーズ終了時のチェック項目

**使用方法**:
- 各タイミングで全項目をチェック
- 未確認項目があれば確認してから進行

---

## 5. プロンプト生成手順

### 5.1 生成タイミングの判断
以下のいずれかに該当する場合、プロンプト生成を開始：

1. **定期的な生成**
   - 当フェーズの全タスクが完了した
   - チャットのトークン使用量が70%を超えた

2. **臨時の生成**
   - プロジェクト方針が大幅に変更された
   - 予期しない問題が発生し、チャットを切り替える必要がある

### 5.2 生成前の準備
1. **成果物の確認**
   - 全ての成果物が完成しているか
   - 成果物が正しい場所に格納されているか
   - ドキュメントが完成しているか

2. **情報の整理**
   - 完了したタスクのリスト化
   - 作成した成果物のリスト化
   - 次フェーズのタスクの明確化
   - 引き継ぎ事項の整理

3. **規約の確認**
   - 規約に変更がないか
   - 追加の制約事項がないか

### 5.3 生成手順
1. **テンプレートの準備**
   - 標準テンプレートをベースに使用
   - フェーズ番号を更新

2. **各セクションの記入**
   - プロジェクト概要: 変更がなければコピー
   - 環境情報: 変更がなければコピー
   - 制約事項: 変更がなければコピー
   - 前フェーズまでの進捗: **必ず更新**
   - 当フェーズの作業内容: **必ず更新**（工程表を参照）
   - 規約の要点: 変更がなければコピー
   - その他: 必要に応じて更新

3. **チェックリストでの確認**
   - 生成時のチェックリストを使用
   - 全項目を確認

4. **ファイル出力**
   - `00_プロンプト/Phase[番号]_to_Phase[番号].md` として保存
   - 文字コード: UTF-8（BOMなし）

### 5.4 生成後の確認
1. **内容の確認**
   - 必須セクションが全て含まれているか
   - 情報が正確か
   - パスが正しいか

2. **サイズの確認**
   - 15,000トークン以内か
   - 超過している場合は簡潔化

3. **テスト読み込み**
   - 生成したプロンプトを実際に読み込んでみる
   - 問題なく理解できるか確認

---

## 6. サイズ管理とトークン節約

### 6.1 推奨サイズ
- **理想**: 8,000～10,000トークン
- **許容**: 10,000～15,000トークン
- **上限**: 15,000トークン

### 6.2 サイズ削減の方法
トークン数が超過した場合、以下の順序で削減：

1. **Level 1: 重複の削除**
   - 同じ情報の繰り返しを削除
   - 冗長な説明を簡潔化

2. **Level 2: 詳細の削減**
   - 規約の全文を要点のみに
   - 例示を減らす
   - コードサンプルを削除

3. **Level 3: 参照への切り替え**
   - 詳細は規約書を参照するよう指示
   - 「詳細は○○を参照」形式に変更

4. **Level 4: セクションの統合**
   - 関連セクションを統合
   - 補足事項を削除

### 6.3 トークン節約のテクニック
1. **簡潔な表現**
   - 冗長な説明を避ける
   - 箇条書きを活用
   - 表形式を活用

2. **参照の活用**
   - 詳細情報は別ファイルを参照
   - 「○○.mdを参照」形式を使用

3. **必要最小限の情報**
   - 必須情報のみを記載
   - Nice-to-haveは削除

---

## 7. バージョン管理

### 7.1 バージョン番号の規則
- **形式**: v[メジャー].[マイナー]
- **例**: v1.0, v1.1, v2.0

**バージョンアップの基準**:
- **メジャーバージョン**: 構造の大幅な変更、重要な追加
- **マイナーバージョン**: 軽微な修正、情報の更新

### 7.2 修正時の対応

#### 7.2.1 軽微な修正（マイナーバージョンアップ）
対象: 誤字脱字、パスの修正、情報の更新

手順:
1. プロンプトファイルを直接修正
2. バージョン番号を更新（v1.0 → v1.1）
3. 修正履歴に記録

#### 7.2.2 重大な修正（メジャーバージョンアップ）
対象: 構造の変更、セクションの追加/削除、タスクの大幅変更

手順:
1. 新しいファイルとして保存
2. 命名: `Phase[番号]_to_Phase[番号]_v[バージョン].md`
3. バージョン番号を更新（v1.9 → v2.0）
4. 修正理由を詳細に記録
5. 旧バージョンは保持

### 7.3 修正履歴の記載
プロンプト末尾に以下のセクションを追加：

```markdown
---

## 修正履歴
- v1.0 (2025-11-25): 初版作成
- v1.1 (2025-11-26): パス情報を修正
- v2.0 (2025-12-01): タスクリストを大幅に変更
```

---

## 8. 品質保証

### 8.1 生成時の品質チェック
以下の項目を必ず確認：

**必須情報の確認**:
- [ ] プロジェクト概要が記載されている
- [ ] 環境情報が正確
- [ ] 制約事項が記載されている
- [ ] 前フェーズの進捗が記載されている
- [ ] 当フェーズのタスクが明確
- [ ] 成果物リストが完全
- [ ] 規約の要点が記載されている
- [ ] 特別指示事項が明確
- [ ] チェックリストが含まれている

**正確性の確認**:
- [ ] ディレクトリパスが正確
- [ ] フェーズ番号が正確
- [ ] 参照ドキュメントのパスが正確
- [ ] 成果物の格納場所が正確

**明確性の確認**:
- [ ] タスクが具体的で理解しやすい
- [ ] 作業手順が明確
- [ ] 完了条件が明確

**サイズの確認**:
- [ ] 15,000トークン以内

### 8.2 使用時の確認
新規チャットでプロンプトを使用する際：

**読み込み後の確認**:
- [ ] プロジェクト全体を理解できた
- [ ] 当フェーズのタスクが明確
- [ ] 参照すべきドキュメントが分かった
- [ ] 作業を開始できる状態

**問題発見時の対応**:
- 情報不足: 規約書等を追加で参照
- 不明確: 工程表等で詳細を確認
- 矛盾: プロンプトを修正（マイナーバージョンアップ）

---

## 9. 実践ガイド

### 9.1 Phase 01完了時のプロンプト生成例

**状況**:
- Phase 01（規約策定）が完了
- 次はPhase 02（要件分析）に移行
- 成果物: 開発規約書、コーディング規約書、ディレクトリ構造設計書、プロジェクト工程表、プロンプト生成規約書

**生成手順**:
1. テンプレートを準備
2. 「前フェーズまでの進捗」にPhase 01の成果物を記載
3. 「当フェーズの作業内容」にPhase 02のタスクを記載（工程表から）
4. 参照ドキュメントに規約書を追加
5. チェックリストで確認
6. `00_プロンプト/Phase01_to_Phase02.md` として保存

### 9.2 トークン超過時のプロンプト生成例

**状況**:
- Phase 06の作業中
- トークン使用量が75%に達した
- まだタスクが残っている

**対応**:
1. 現在の進捗を整理
2. 残りタスクを明確化
3. 臨時プロンプトを生成
4. 命名: `Phase06_to_Phase06_continue.md`
5. 新規チャットで作業を継続
6. Phase 06完了時に改めて正式プロンプトを生成

---

## 10. よくある質問（FAQ）

### Q1: プロンプトが15,000トークンを超えた場合は？
**A**: 以下の順序で削減してください：
1. 重複削除 → 2. 詳細削減 → 3. 参照切り替え → 4. セクション統合

### Q2: フェーズ途中でチャットを切り替える必要がある場合は？
**A**: 臨時プロンプトを生成してください。命名は `Phase[番号]_to_Phase[番号]_continue.md`

### Q3: 規約が変更された場合は？
**A**: 次のプロンプトに変更内容を反映し、修正履歴に記録してください。

### Q4: プロンプトの内容に誤りを発見した場合は？
**A**: 軽微な誤りはマイナーバージョンアップで修正。重大な誤りはメジャーバージョンアップで対応。

### Q5: 前フェーズの成果物が見つからない場合は？
**A**: プロンプトに記載された格納場所を確認。それでも見つからない場合は前チャットを確認。

---

## 11. チェックリスト

### 11.1 プロンプト生成時のチェックリスト
- [ ] テンプレート構造に従っている
- [ ] プロジェクト概要が正確
- [ ] 環境情報（ディレクトリパス）が正確
- [ ] 制約事項が記載されている
- [ ] 前フェーズの進捗が最新
- [ ] 当フェーズのタスクが明確
- [ ] 成果物リストが完全
- [ ] 参照ドキュメントが明記されている
- [ ] 規約の要点が記載されている
- [ ] 特別指示事項が明確
- [ ] チェックリストが含まれている
- [ ] ファイルサイズが15,000トークン以内
- [ ] ファイル名が命名規則に従っている
- [ ] 格納場所が正しい（00_プロンプト/）

### 11.2 プロンプト使用時のチェックリスト
- [ ] プロンプト全体を読み込んだ
- [ ] プロジェクト概要を理解した
- [ ] 作業ディレクトリの存在を確認した
- [ ] 必須ドキュメントを確認した
- [ ] 前フェーズの成果物を確認した
- [ ] 当フェーズのタスクを理解した
- [ ] 規約・制約を理解した
- [ ] 初期タスクを開始できる状態
- [ ] 不明点がない（あれば規約書等を参照）

### 11.3 フェーズ終了時のチェックリスト
- [ ] 全てのタスクが完了している
- [ ] 全ての成果物が作成されている
- [ ] 成果物が正しい場所に格納されている
- [ ] ドキュメントが完成している
- [ ] テスト（該当する場合）が完了している
- [ ] 次フェーズへの引き継ぎ事項が明確
- [ ] 次フェーズ用プロンプトが生成されている
- [ ] 完了報告が作成されている
- [ ] プロンプト生成時のチェックリストを実施した

---

## 12. まとめ

### 12.1 重要ポイント
1. **プロンプトは必ず生成**: 各フェーズ終了時に必ず生成
2. **標準構造に従う**: テンプレートの10セクションを必ず含める
3. **情報を正確に**: 特にパスとタスクは正確に記載
4. **サイズを管理**: 15,000トークンを超えない
5. **チェックリストを活用**: 生成時・使用時・終了時に必ずチェック

### 12.2 成功のための心得
- プロンプトはプロジェクトの継続性を保証する重要な資産
- 丁寧に作成すれば、次のチャットでスムーズに作業を開始できる
- チェックリストを活用して品質を保証する
- 問題が発生したら規約を改善する

---

**承認**: Phase 01完了時  
**改訂履歴**:
- v1.0 (2025-11-25): 初版作成
